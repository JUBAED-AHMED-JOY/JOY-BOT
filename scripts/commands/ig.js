module.exports.config = {
  name: `${global.config.PREFIX}`,
  version: "4.0.0",
  permission: 0,
  credits: "Joy",
  description: "Crush video with caption (API from GitHub)",
  prefix: true,
  category: "user",
  cooldowns: 5
};

module.exports.run = async ({ api, event }) => {
  const axios = require("axios");
  const request = require("request");
  const fs = require("fs-extra");
  const path = require("path");


  const captions = [
    "=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğŸ°ğŸ’à¦¶à§€à§à¦à¦¤à§à¦ à¦¶à§€à§à¦à¦¤à§à¦ à¦­à¦¾à§à¦à¦¬à§à¦ à¦•à¦¿à§à¦à¦¸à§‡à§à¦à¦°à§à¦ à¦œà¦¾à§à¦à¦¨à¦¿à§à¦ à¦à§à¦à¦•à§à¦à¦Ÿà¦¾à§à¦ à¦…à§à¦à¦­à¦¾à§à¦à¦¬à§à¦_ğŸ™ŠğŸ™ˆ\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ ",
" === ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€ ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n--áƒ¦áƒ¦ğŸ¦‹ğŸ–¤âœ¨-\n\n--ğ‹ğ¨ğ¯ğ ğ¢'ğ¬ ğğğšğ®ğ­ğ¢ğŸğ®ğ¥ __â˜ºï¸ğŸ¦‹âœ¨\n\n--ğ¥ğŸ ğ­ğ¡ğ ğ¥ğ¨ğ¯ğğ ğ¨ğ§ğ ğ¢ğ¬ ğ«ğ¢ğ ğ¡ğ­..!ğŸ¦‹ğŸğŸ’«\n\n-à¦­à¦¾à¦²à§‹à¦¬à¦¾à¦¸à¦¾ à¦¸à§à¦¨à§à¦¦à¦° ___,ğŸ–¤ğŸ¦‹\n\n- à¦¯à¦¦à¦¿ à¦ªà§à¦°à¦¿à§Ÿ à¦®à¦¾à¦¨à§à¦·à¦Ÿà¦¿ à¦¸à¦ à¦¿à¦• à¦¹à§Ÿ....!â˜ºï¸ğŸ–¤ğŸ™‚âœ¨ğŸŒ¼\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ ",
"___=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nâ¥â—âƒ! à¦¶à§‚à¦¨à§à¦¯à¦¤à¦¾à§Ÿ à¦­à¦¾à¦¸à¦¿ğŸ™ƒ \n\nâ¥à¦•à¦–à¦¨à§‹ à¦¹à¦¾à¦¸à¦¿ -ğŸ˜ğŸ’š_à¦†à¦¬à¦¾à¦° à¦•à¦¾à¦à¦¦à¦¿!-ğŸ˜…\n\nâ¥à¦¬à§‡à¦²à¦¾ à¦¶à§‡à¦·à§‡ ğŸŒŒà¦¶à§‚à¦¨à§à¦¯à¦¤à¦¾à§Ÿ à¦œà§œà¦¿à§Ÿà§‡ à¦“ à¦ªà§‚à¦°à§à¦£à¦¤à¦¾ à¦–à§à¦à¦œà¦¿ğŸ˜Šâ¤\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–--ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n â¥Â»Ì½Í“Ì¶Ì½Í“Ì¶Ì½Í“â‘…âƒâœºâ¥á­„â¥\n\n___ğŸ’š__à¦ªà§ƒà¦¥à¦¿à¦¬à§€à¦Ÿà¦¾ à¦†à¦œ...\n\nà¦®à¦¿à¦¥à§à¦¯à§‡ à¦®à¦¾à§Ÿà¦¾à¦¤à§‡ à¦­à¦°à¦¾...!ğŸ’šğŸŒº\n\n____ğŸ¥€_à¦¤à¦¾à¦‡ à¦¤à§‹ à¦ªà§ƒà¦¥à§€à¦¬à§€à¦° à¦®à¦¾à¦¨à§à¦· à¦†à¦œ....!\n\nà¦…à¦­à¦¿à¦¨à§Ÿà§‡à¦° à¦¸à§‡à¦°à¦¾...ğŸ‘ğŸ¥€\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğŸ’œğŸ”ğŸŒˆ ___\n\n- ğ—§ğ—µğ—¶ğ˜€ ğ—®ğ—¯ğ—¼ğ˜‚ğ˜ ğ—¹ğ—¶ğ—»ğ—²-!! ğŸ˜½ğŸ§¡âœ¨\n\nğŸ_à¦¸à¦¬à¦¾à¦‡ à¦¤à§‹ à¦–à§à¦¶à¦¿ à¦šà¦¾à¦¯à¦¼_à¦†à¦° à¦†à¦®à¦¿ à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¾ à¦–à§à¦¶à¦¿à¦¤à§‡ à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦šà¦¾à¦‡âšœï¸â€” -!!-) ğŸ˜ŠğŸ–¤\n\n___ğŸ’œğŸ”ğŸŒˆ\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n>ğŸ°âœ¨ğ‘»ğ’‰ğ’Šğ’” ğ’ğ’Šğ’ğ’† ğ’Šğ’” ğ’‡ğ’ğ’“ ğ’šğ’ğ’–ğŸ–¤ğŸŒ¸\n\n___à¦šà§‹à¦–à§‡à¦° à¦¦à§‡à¦–à¦¾à§Ÿ à¦¨à§Ÿ,à¦®à¦¨à§‡à¦° à¦¦à§‡à¦–à¦¾à§Ÿ à¦­à¦¾à¦²à¦¬à¦¾à¦¸à¦¿!!ğŸ˜‡âœ¨\n\n- à¦•à¦¾à¦›à§‡ à¦¥à¦¾à¦•à§‹ à¦•à¦¿à¦‚à¦¬à¦¾ à¦¦à§‚à¦°à§‡,à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦­à§‡à¦¬à§‡à¦‡ à¦¹à¦¾à¦¸à¦¿!!ğŸ–¤ğŸ°\n\nğŸ’–ğŸ¦‹\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n:à¼…à¼ğŸ’™ğŸ¦‹\nà¼†ğ“ğ¡ğ¢ğ¬ ğšğ›ğ¨ğ®ğ­ ğ¥ğ¢ğ§ğ_âš ï¸ğŸ™…ğŸ»â€â™‚ï¸âœ¨\n\nğŸ˜½ï¸µÛµà¦®à¦¾à¦¨à§à¦·! à¦¹à¦šà§à¦›à§‡!à¦¬à§ƒà¦·à§à¦Ÿà¦¿à¦°!à¦®à¦¤à§‹!Life a ! à¦…à¦¨à§‡à¦• à¦®à¦¾à¦¨à§à¦· !à¦†à¦¸à¦¬à§‡!à¦…à¦¨à§‡à¦• à¦®à¦¾à¦¨à§à¦· !à¦¯à¦¾à¦¬à§‡!ğŸ’”ğŸ¥°\n\n:à¼…à¼ğŸ’™ğŸ¦‹ à¦¸à¦ à¦¿à¦•!à¦®à¦¾à¦¨à§à¦·à¦Ÿà¦¾!à¦ à¦¿à¦•à¦‡!à¦›à¦¾à§Ÿà¦¾!à¦¹à§Ÿà§‡!à¦ªà¦¾à¦¶à§‡!à¦¥à¦¾à¦•à¦¬à§‡ -/ à°Œï¸µğŸ’šğŸŒ»\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n:(-ğ™„ ğ™–ğ™¢ ğ˜¼ğ™™ğ™™ğ™ğ™˜ğ™©ğ™šğ™™ ğ™ğ™¤ğŸ‘€ğŸ™ˆ\n\n_')ğ™ˆğ™® ğ™ğ™–ğ™«ğ™¤ğ™§ğ™ğ™©ğ™š ğ™‹ğ™šğ™§ğ™¨ğ™¤ğ™£..!\n\nğŸ°ğŸ¦‹ -(^à¦†à¦®à¦¿ à¦†à¦®à¦¾à¦° à¦ªà§à¦°à¦¿à¦¯à¦¼ à¦®à¦¾à¦¨à§à¦·à¦Ÿà¦¾à¦° à¦ªà§à¦°à¦¤à¦¿ à¦†à¦¸à¦•à§à¦¤ >!ğŸ’–ğŸ”ğŸ­)ğŸ˜‡\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",

"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ™—ğ™šğ™¡ğ™ğ™šğ™«ğ™š ğ™©ğ™ğ™ğ™¨ ğ™¡ğ™ğ™£ğ™š-!!ğŸ¦‹ğŸ­\n\nğŸ°' â€”'à¦ªà¦¾à¦°à¦«à§‡à¦•à§à¦Ÿ' à¦•à¦¾à¦‰à¦•à§‡ à¦ªà¦¾à¦¬à¦¾à¦° à¦¥à§‡à¦•à§‡'à¦•à¦¾à¦‰à¦•à§‡' à¦ªà¦¾à¦°à¦«à§‡à¦•à§à¦Ÿ' à¦¬à¦¾à¦¨à¦¿à§Ÿà§‡ à¦¨à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à¦¾à¦Ÿà¦¾' à¦¬à§œ à¦…à¦°à§à¦œà¦¨'--)ğŸŒ¼ğŸ’œ\n\n___ğŸ’ğŸ–‡ï¸âœ¨___\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",
"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nÂ°ğŸ¹ğŸ’™ğŸ’\n\n_ğ—§ğ—¿ğ˜‚ğ˜€ğ˜ ğ—ºe ğŸ”ğŸ’š\nÂ°\n\n__!!â˜ï¸âœ¨ğŸŒºà¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦ªà¦¾à¦“à§Ÿà¦¾à¦° à¦¦à¦¾à¦¬à¦¿!à¦†à¦®à¦¿ à¦®à§ƒà¦¤à§à¦¯à§à¦° à¦ªà¦°à¦“ à¦›à¦¾à§œà¦¬à§‹ à¦¨à¦¾,,ğŸ”ğŸ’š ğŸ™‚\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜",

"=== ã€Œğ—£ğ—¿ğ—²ğ—³ğ—¶ğ˜… ğ„ğ¯ğğ§ğ­ã€  ===\n  --â–-- ğŒğƒ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜ --â–--\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\n__ğ—¥ğ—¶ğ—´ğ—µğ˜ ğ—½ğ—²ğ—¼ğ—½ğ—¹ğ—² ğ—®ğ—¿ğ—² ğ—®ğ—¹ğ˜„ğ—®ğ˜†ğ—²ğ˜€ ğ—®ğ—»ğ—´ğ—¿ğ˜† ğ—¯ğ—²ğ—°ğ—®ğ˜‚ğ˜€ğ—² ğ˜ğ—µğ—²ğ˜† ğ—°ğ—®ğ—»'ğ˜ ğ˜€ğ˜ğ—®ğ—»ğ—± ğ˜†ğ—¼ğ˜‚ ğ˜„ğ—¶ğ˜ğ—µ ğ—¼ğ˜ğ—µğ—²ğ—¿ğ˜€ğŸŒ¸âœ¨\n\n___à¦¸à¦ à¦¿à¦• à¦®à¦¾à¦¨à§à¦· à¦¸à¦¬ à¦¸à¦®à§Ÿà¦‡ à¦°à¦¾à¦—à¦¿ à¦¹à§Ÿ'\n\nà¦•à¦¾à¦°à¦£ à¦¤à¦¾à¦°à¦¾ à¦…à¦¨à§à¦¯à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¤à§‹à¦®à¦¾à¦•à§‡ à¦¸à¦¹à§à¦¯ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡ à¦¨à¦¾à¦¹à§!ğŸ˜ŒğŸ«¶ğŸ–¤\n\nâœ¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âœ¢\n\nğ‚ğ«ğğšğ­ğ¨ğ« : ğŠğˆğğ† _ ğ‰ğ”ğğ€ğ„ğƒ ğ€ğ‡ğŒğŒğ„ğƒ ğ‰ğğ˜"
  ];
  const caption = captions[Math.floor(Math.random() * captions.length)];

  try {

    const apiRes = await axios.get("https://raw.githubusercontent.com/JUBAED-AHMED-JOY/Joy/main/api.json");
    const apiData = apiRes.data;

    if (!apiData.joy11) {
      return api.sendMessage("âŒ API link not found in JSON", event.threadID, event.messageID);
    }

    const baseUrl = apiData.joy11; // à¦à¦‡à¦–à¦¾à¦¨à§‡à¦‡ API base URL
    const apiUrl = `${baseUrl}/random?JOY=crush`;


    const res = await axios.get(apiUrl);
    const videoUrl = res.data; // à¦¸à¦°à¦¾à¦¸à¦°à¦¿ mp4 link

    if (!videoUrl) {
      return api.sendMessage("âŒ API did not return video link", event.threadID, event.messageID);
    }


    const cacheFolder = path.join(__dirname, "cache");
    if (!fs.existsSync(cacheFolder)) fs.mkdirSync(cacheFolder);

    const cachePath = path.join(cacheFolder, "crush.mp4");


    const sendVideo = () => {
      api.sendMessage(
        {
          body: caption,
          attachment: fs.createReadStream(cachePath)
        },
        event.threadID,
        () => fs.unlinkSync(cachePath),
        event.messageID
      );
    };


    return request(videoUrl)
      .pipe(fs.createWriteStream(cachePath))
      .on("close", sendVideo)
      .on("error", () => {
        api.sendMessage("âŒ Video download failed", event.threadID, event.messageID);
      });

  } catch (err) {
    console.error(err);
    return api.sendMessage("âŒ API error", event.threadID, event.messageID);
  }
};